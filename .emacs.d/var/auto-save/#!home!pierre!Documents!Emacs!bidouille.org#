#+TITLE: Emacs pour le développement
#+AUTHOR: Ludovic Courtès
#+EMAIL: ludovic.courtes@inria.fr
#+DATE: 16 octobre 2014
#+STARTUP: content hidestars

Salut à toi !  Bienvenue dans la bidouille !

Utilise « C-c C-o » (control+c puis control+o) pour suivre les liens
(les trucs soulignés en bleu ci-dessous).

Ce fichier est disponible à
http://people.bordeaux.inria.fr/lcourtes/bidouille.org.

* prérequis

GNU Emacs 24.3+

Configuration du [[info:emacs#Packages][système de paquets]] :

#+BEGIN_SRC emacs-lisp
  (require 'package)
  (setq package-archives '(("gnu" . "http://elpa.gnu.org/packages/")
                           ("ELPA" . "http://tromey.com/elpa/")
                           ("Marmelade" . "http://marmalade-repo.org/packages/")))
  
  ;; Make the installed packages available.
  (package-initialize)
  
#+END_SRC

* [[info:emacs#Compilation%20Mode][compilation]]

M-x compile
C-x `   (next-error)

* [[info:emacs#Interactive%20Shell][shell]]

M-x shell
C-c C-p (comint-previous-prompt)
C-c C-n (comint-next-prompt)
C-c C-o (comint-delete-output)

* coloration

** [[info:emacs#Font%20Lock][coloration syntaxique]]

#+BEGIN_SRC emacs-lisp
  (global-font-lock-mode 1)
#+END_SRC

** [[info:emacs#Matching][correspondance des parenthèses]]

#+BEGIN_SRC emacs-lisp
  (show-paren-mode 1)
#+END_SRC

** [[info:emacs#Highlight%20Interactively][coloration des changements]]

M-x highlight-changes-mode

** [[info:emacs#Highlight%20Interactively][coloration de trucs spécifiques]]

M-x highlight-regexp (C-x w h)
M-x unhighlight-regexp (C-x w u)
M-x hl-line-mode

** coloration de mots récurrents

*** [[info:emacs#Packages][préparation]]

M-x package-list-packages

installe le paquet 'highlight-symbol'

*** utilisation

M-x highlight-symbol-mode

** [[info:emacs#Glasses][coloration de la casse de chameau]]

M-x glasses-mode

** [[info:emacs#Spelling][correction orthographique]] (dans les commentaires)

M-x flyspell-prog-mode

* affichage

** [[help:bug-reference-prog-mode][bug-reference-prog-mode]]

faire des boutons sur les références à des rapports de bug

** [[info:emacs#Which%20Function][fonction courante dans la ligne de mode]]

M-x which-function-mode

** pliage de code

[[info:emacs#Packages][installer]] le paquet 'fold-dwim'.

#+BEGIN_SRC emacs-lisp
  (require 'fold-dwim)
  (global-set-key (kbd "<f7>")      'fold-dwim-toggle)
  (global-set-key (kbd "<M-f7>")    'fold-dwim-hide-all)
  (global-set-key (kbd "<S-M-f7>")  'fold-dwim-show-all)
  
#+END_SRC

* gestion de version
** [[info:emacs#Version%20Control][VC]] : générique

C-x v d (vc-dir)
C-x v l (vc-print-log)
C-x v L (vc-print-root-log)
C-x v g (vc-annotate)
  + d, D, a, etc.

** [[info:magit#Top][Magit]] : spécifique à Git

installer avec M-x package-list-packages

M-x magit-status
stage/unstage, par hunk
branches
rebase

* navigation dans le source
** [[info:emacs#Motion%20in%20C][la base]] (en C)

C-M-a (c-beginning-of-defun)
C-M-e (c-end-of-defun)
M-a (c-beginning-of-statement)
M-e (c-end-of-statement)
M-} (forward-paragraph)
M-{ (backward-paragraph)

** [[info:emacs#Other%20C%20Commands][pour la casse de chameau]]

M-x subword-mode

** [[info:emacs#Grep%20Searching][recherche avec grep]]

M-x grep
M-x rgrep

** navigation dans les fonctions
*** [[info:emacs#Tags][avec etags]]

M-! etags *.c RET
M-.

*** avec [[http://gnu.org/s/global][GNU GLOBAL]]

**** avec [[info:global#Emacs%20editor][gtags]] (basique, fourni avec GLOBAL)

#+BEGIN_SRC emacs-lisp
  (setq c-mode-hook
        '(lambda ()
           (gtags-mode 1)))
  
  (define-key gtags-mode-map [(meta ?.)] 'gtags-find-tag)
  (define-key gtags-mode-map [(meta ?*)] 'gtags-pop-stack)
  
#+END_SRC

M-. et M-*
M-x gtags-find-pattern
M-x gtags-find-rtag

**** avec [[http://www.emacswiki.org/emacs/xgtags.el][xgtags]] (plus sophistiqué)

M-. et M-*
C-c w c (xgtags-find-rtag)
C-c w s (xgtags-find-symbol)
C-c w n (xgtags-select-next-tag)
C-c w p (xgtags-select-prev-tag)
C-c w r (xgtags-query-replace-regexp)

*** avec [[info:semantic#Top][Semantic]]

M-x semantic-mode
C-c , J (semantic-complete-jump)

problème : pas de pile de symboles, et donc pas de M-*

* écriture

** [[info:emacs#Indentation][indentation]]

TAB (c-indent-line-or-region)
C-M-\ (indent-region)
M-x electric-indent-mode

** [[info:emacs#Matching][insertion de parenthèses etc.]]

M-x electric-pair-mode

** [[info:autotype#Hippie%20Expand][complétion avec « hippie-expand »]]

#+BEGIN_SRC emacs-lisp
  (define-key global-map [(meta ?/)]  'hippie-expand)
  
#+END_SRC

** [[info:semantic#Semantic%20mode][complétion avec Semantic]]

M-x semantic-mode
M-TAB (complete-symbol, avec semantic-completion-at-point-function)
[[info:semantic#Idle%20Completions%20Mode][M-x semantic-idle-completions-mode]]

* trucs qui dépotent avec Semantic

M-x semantic-ia-show-summary
M-x semantic-highlight-func-mode
M-x semantic-stickyfunc-mode

* déverminage : [[info:emacs#Debuggers][GUD]]

M-x gdb
C-x SPC (gud-break)
C-x C-a C-s (gud-step)
C-x C-a C-n (gud-next)
C-x C-a < (gud-up)
C-x C-a > (gud-down)
M-x gdb-display-stack-buffer

* correction à la volée du code

installer Flycheck avec M-x package-list-packages

M-x flycheck-mode
M-x flycheck-select-checker
C-c ! n (flycheck-next-error)
C-c ! p (flycheck-previous-error)

* la prochaine fois...

Gnus, ERC, Org, Geiser, w3m, eww, etc.
